# HonyRun 后端详细规划设计 - WebFlux响应式版本

**项目名称**: HonyRun 后端系统
**版本**: 2.0.0
**架构**: Spring WebFlux 响应式架构
**创建日期**: 2025-08-03
**最后更新**: 2025-10-26
**作者**: Mr.Rey


## 1. 文档体系说明

本文档为HonyRun后端系统详细规划设计文档的主目录和概述，整个设计文档采用**总分结构**，分为多个专项文档，确保内容清晰、易于维护。

### 1.1 文档结构

| 文档编号 | 文档名称 | 主要内容 |
|---------|---------|--------|
| 1 | 总体设计概述 | 项目概述、架构总览、技术栈、文档体系 |
| 2 | 响应式技术架构设计 | 响应式架构原理、组件设计、流程设计 |
| 3 | 项目结构与配置规范 | 代码结构、配置文件、资源文件组织 |
| 4 | 响应式安全体系设计 | 安全配置、JWT实现、权限管理 |
| 5 | 响应式数据访问设计 | R2DBC配置、实体设计、仓库层实现 |
| 6 | 响应式服务层与缓存设计 | 服务层实现、Redis配置、缓存策略 |
| 7 | 响应式监控与运维设计 | 监控指标、日志系统、统一监控实现 |
| 8 | 响应式接口设计 | API版本管理、路由设计、响应格式 |
| 9 | 响应式测试与质量保障 | 测试策略、最小化Mock实践、测试规范 |


### 1.2 文档更新说明

- 本版本文档基于原有`后端详细规划设计-WebFlux.md`进行重构和更新
- 所有内容均与项目当前实际情况保持一致
- 采用模块化、分层设计，便于后续维护和更新
- 根据项目实现情况，调整了文档结构和内容，移除了部分冗余文档，合并了相关内容


## 2. 项目概述

HonyRun System 是基于Spring WebFlux响应式架构的面向内部管理的业务支撑平台，提供便捷的业务处理、数据查询和系统管理功能。系统采用非阻塞I/O和事件驱动编程模型，支持多用户并发访问，包含响应式业务功能模块和系统管理模块，同时提供完善的响应式日志记录和异常提醒机制。

### 2.1 核心特性

- **非阻塞I/O**: 全栈非阻塞，从Web层到数据访问层
- **高并发处理**: 基于事件循环的高效并发模型
- **背压支持**: 内置背压机制，防止系统过载
- **函数式编程**: 支持函数式路由和处理器
- **响应式数据流**: 端到端的响应式数据处理
- **弹性伸缩**: 优秀的资源利用率和伸缩性
- **完整监控**: 集成Prometheus和Micrometer，提供全面的性能监控
- **安全路径管理**: 基于PathUtils和PathType枚举的统一路径管理机制，支持安全的路径操作和验证

## 3. 技术栈概述

### 3.1 核心技术组件

| 技术组件 | 版本 | 说明 |
|---------|------|------|
| Java | 21 | 支持虚拟线程和现代Java特性 |
| Spring Boot | 3.5.7 | 响应式框架核心版本 |
| Spring WebFlux | 6.1.x | 响应式Web框架 |
| Project Reactor | 3.6.x | 响应式编程库 |
| Spring Data R2DBC | 3.3.x | 响应式数据访问 |
| R2DBC Pool | 1.0.x | 响应式连接池 |
| MySQL R2DBC | 1.1.x | 响应式数据库驱动 |
| Redis Reactive | 3.3.x | 响应式缓存客户端 |
| Lettuce | 6.3.0.RELEASE | Redis客户端 |
| Netty | 4.1.x | 响应式网络服务器 |
| JWT | jjwt 0.12.6 | JSON Web Token实现 |
| Spring Security | 6.1.x | 响应式安全框架 |
| SpringDoc OpenAPI | 2.2.0 | Swagger文档支持 |


### 3.2 构建与测试工具

| 工具 | 版本 | 说明 |
|------|------|------|
| Maven | 3.8+ | 构建工具 |
| JMH | 1.37 | 基准测试框架 |
| JaCoCo | 0.8.11 | 代码覆盖率工具 |
| SpotBugs | 4.8.2.0 | 静态代码分析 |
| PMD | 3.21.2 | 代码质量检查 |
| Checkstyle | 3.3.1 | 代码风格检查 |

## 4. 系统架构总览

### 4.1 架构层次

1. **表现层**: 基于WebFlux的响应式API，支持函数式路由和注解式控制器
2. **安全层**: Spring Security WebFlux，JWT认证，响应式权限控制
3. **业务层**: 响应式服务实现，基于Reactor的异步业务处理
4. **数据访问层**: Spring Data R2DBC，响应式仓库接口
5. **基础设施层**: MySQL/Redis/监控系统等

### 4.2 关键依赖关系

- MySQL作为核心数据存储，必须正常连接
- Redis作为核心缓存服务，必须正常连接
- 应用启动时自动检测MySQL和Redis连接状态
- 任一组件连接失败将立即终止应用启动

## 5. 环境配置要求

### 5.1 开发环境要求

- JDK 21
- Maven 3.8+
- MySQL 8.0+（端口8906）
- Redis 8.0+（端口8902）
- IDE推荐：IntelliJ IDEA或Eclipse

### 5.2 运行环境配置

**数据库配置**:
- MySQL: 端口8906, 用户honyrunMysql, 密码honyrun@sys, 数据库honyrunDb
- Redis: 端口8902, 密码honyrun@sys, 数据库DB1
- 连接检测: 启动时执行SELECT 1和PING命令验证连接
- 超时设置: 每个组件连接检测最大等待10秒

## 6. 文档使用指南

1. **新团队成员**：建议从总体设计概述开始，了解项目整体架构
2. **开发人员**：根据具体开发任务，参考相应的专项设计文档
3. **架构师**：关注总体设计和技术架构设计文档
4. **测试人员**：重点参考响应式测试与质量保障文档
5. **维护人员**：重点参考监控与运维设计文档

## 7. 后续文档导航

请根据需要参考以下专项设计文档，获取更详细的设计信息：

- [2-响应式技术架构设计](./2-响应式技术架构设计.md)
- [3-项目结构与配置规范](./3-项目结构与配置规范.md)
- [4-响应式安全体系设计](./4-响应式安全体系设计.md)
- [5-响应式数据访问设计](./5-响应式数据访问设计.md)
- [6-响应式服务层与缓存设计](./6-响应式服务层与缓存设计.md)
- [7-响应式监控与运维设计](./7-响应式监控与运维设计.md)
- [8-响应式接口设计](./8-响应式接口设计.md)
- [9-响应式测试与质量保障](./9-响应式测试与质量保障.md)
